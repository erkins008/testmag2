jQuery(document).ready(function(){var t={};t.debugMode=!1,t.log=function(){t.debugMode&&console&&console.log.apply(console,arguments)},t.operationalElements=function(t){var e=jQuery(".ILikePost");if(!e)return void t("Container not found under selector %s",".ILikePost");var o={vote_button:e.find(".vote_img"),likes_no:e.find(".likes_no"),post_id:e.attr("post_id"),note_thanks:e.attr("note_thanks"),note_forbidden:e.attr("note_forbidden")};return o.vote_button&&o.likes_no&&o.post_id?o:void t("Some of the main elements not vote_button: %s, likes_no: %s, post_id: %s ",!!o.vote_button,!!o.likes_no,!!o.post_id)}(t.log),function(t,e,o,n){var i={};return e&&o?(i.cookie=function(){var t="recipe_"+o.post_id;return{markAsVoted:function(){var e=new Date;e.setFullYear(e.getFullYear()+1),n(e),document.cookie=t+"= voted; expires="+e},isMarkedAsVoted:function(){return n("Cookie: %s",document.cookie),-1==document.cookie.indexOf(t)?!0:!1}}}(),i.buttonView=function(t){function e(e){e?t.bind({mouseover:function(){t.attr("src",n)},mouseout:function(){t.attr("src",o)},mousedown:function(){t.attr("src",i)}}):t.unbind("mouseover").unbind("mouseout").unbind("mousedown")}var o=t.attr("src"),n=t.attr("over_img"),i=t.attr("pressed_img"),s=t.attr("wait_img");return e(!0),{turnNormal:function(){t.attr("src",o),e(!0)},turnResponseWaiting:function(){t.attr("src",s),e(!1)}}}(o.vote_button),i.lastMouseEvent=null,i.dialogFactory=function(e){var n=t("<div/>"),i=o.vote_button.parent();n.css({position:"absolute",zIndex:100,width:400>t(window).innerWidth()?t(window).innerWidth():400}),n.appendTo(i),n.text(e);var s=i.width()/2-n.width()/2;return s=i.offset().left+n.width()+s>=t(window).innerWidth()?s+(t(window).innerWidth()-n.width()-i.offset().left-s):s,n.css({left:s,top:-n.height()}),n},i.screenMessage=function(e,o){return{thanksMessage:function(n){o(e.note_thanks).fadeOut({duration:n||2500,complete:function(){t(this).remove()}})},forbiddenMessage:function(n){o(e.note_forbidden).fadeOut({duration:n||2e3,complete:function(){t(this).remove()}})}}}(o,i.dialogFactory),i.makeVoteRequest=function(i){t.ajax({type:"POST",url:e,data:{action:"vote_for_post",post_id:o.post_id},dataType:"json",success:function(t){try{if(!t)throw new Error("Wrong response, must be a JSON:"+JSON.stringify(t));n("Response: %s",JSON.stringify(t)),i.success&&i.success(t)}catch(e){n(e.toString())}},error:function(t){n("Ajax request error: %s",JSON.stringify(t))},complete:function(){i.complete&&i.complete()}})},i.tryToVote=function(){return i.cookie.isMarkedAsVoted()?(i.buttonView.turnResponseWaiting(),void i.makeVoteRequest({success:function(t){if(!t.likes_no)throw new Error("Wrong response, doesn't contain 'likes_no' variable: %s",JSON.stringify(t));o.likes_no.text(t.likes_no),i.screenMessage.thanksMessage()},complete:function(){i.cookie.markAsVoted(),i.buttonView.turnNormal(),i.lastMouseEvent=null}})):(n("Vote ain't permitted !"),i.screenMessage.forbiddenMessage(),void(i.lastMouseEvent=null))},void o.vote_button.click(function(t){i.lastMouseEvent||(i.lastMouseEvent=t,i.tryToVote())})):void n("Some variable are not set: ajaxurl:%s, identifiers:%s",!!e,!!o)}(jQuery,ajaxurl||{},t.operationalElements,t.log)});